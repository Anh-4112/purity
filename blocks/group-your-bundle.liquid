{% liquid
  assign theme_st = settings
  assign block_st = block.settings
  assign section_st = section.settings
  assign product_image_ratio = theme_st.product_image_ratio
  assign title = block_st.title
  assign description = block_st.description
  assign text_alignment = block_st.text_alignment
  assign heading_size = block_st.heading_size
  assign header_size = ''
  if heading_size == 'small'
    assign header_size = 'h3'
  elsif heading_size == 'large'
    assign header_size = 'h1'
  endif
  assign show_progress_bar = block_st.show_progress_bar
  assign enable_quantity = block_st.enable_quantity
  assign ratio = '3/4'
  if product_image_ratio != 'adapt'
    case product_image_ratio
      when 'square'
        assign ratio = '1/1'
      when 'landscape'
        assign ratio = '4/3'
      when 'portrait'
        assign ratio = '3/4'
    endcase
  else
    assign ratio = '3/4'
  endif
%}
{% style %}
  .product_bundle .product-item {
    --input-height: 4rem;
    --btn-padding-y: 1rem;
    --btn-padding-x: 1.5rem;
  }
  .bundle-sticky {
    border-color: var(--color-heading);
  }
  .skeleton-product__info {
    height: 1rem;
    border-radius: 10px;
    background: var(--color-background-2);
    margin-bottom: 1rem;
  }
  @media (min-width: 1025px) {
    .product_bundle .product-item {
      --input-height: 5.2rem;
      --btn-padding-y: 1.5rem;
      --btn-padding-x: 3rem;
    }
  }
  @media screen and (max-width: 1024.98px) {
    .bundle-header{
      text-align: left;
    }
    .bundle-title{
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .bundle-content{
      height: 0;
    }
  }
{% endstyle %}
<div
  class="bundle-sticky border rounded sticky top-30 p-20 p-1025-40 flex column gap-20 gap-1025-30"
  style="--border-height: 2px;"
  data-enable-quantity="{{ enable_quantity }}"
>
  {%- if title != blank or description != blank -%}
    <bundle-header
      class="bundle-header block text-{{ text_alignment }}"
    >
      <div class="bundle-title mb-10">
        {%- if title != blank -%}
          <h2 class="block section-heading {{ header_size }}">
            {{ title }}
          </h2>
        {%- endif -%}
        <span
          class="toggle-bundle w-30 h-custom hidden-1025 inline-flex flex-end align-center"
          style="--height: 30px;"
        >
          <svg class="icon icon-down icon-rotate transition-short" width="9" height="6" viewBox="0 0 9 6">
            <use href="#icon-arrow-down" />
          </svg>
        </span>
      </div>
      {%- if description != blank -%}
        <div class="section-description prose">
          {{ description }}
        </div>
      {%- endif -%}
    </bundle-header>
  {%- endif -%}
  <div class="bundle-content flex column gap-20 gap-1025-30">
    {% if show_progress_bar %}
      <bundle-progress-bar data-minimum="{{ section_st.minimum }}" data-section-id="{{ section.id }}">
        <div class="progress-bar rounded-10 h-custom bg-grey relative" style="--height: 6px;">
          <div class="progress rounded-10 h-custom absolute left-0 inset-y-0 transition"></div>
        </div>
      </bundle-progress-bar>
    {% endif %}
    <div class="bundle-items__wrapper custom-scrollbar">
      <div class="bundle-content__items flex column gap-20">
        {% for item in (1..section_st.maximum) %}
          <div class="skeleton-product flex gap-15" data-product-bundle-variant>
            <figure
              class="skeleton-product__media rounded-10 media relative overflow-hidden align-self-start bg-secondary flex-auto w-custom"
              data-product-bundle-variant-media
              style="--aspect-ratio: {{ ratio }};--width: 10rem;"
            ></figure>
            <div
              class="skeleton-product__details grow-1 flex column justify-center"
              style="--height: 1rem;"
              data-product-bundle-variant-content
            >
              <span
                class="skeleton-product__info skeleton-1 h-custom bg-secondary rounded-10 max-w-custom-all mb-10"
                style="--max-width: 100%;"
              ></span>
              <span
                class="skeleton-product__info skeleton-2 h-custom bg-secondary rounded-10 max-w-custom-all mb-10"
                style="--max-width: 6rem;"
              ></span>
              <span
                class="skeleton-product__info skeleton-3 h-custom bg-secondary rounded-10 max-w-custom-all"
                style="--max-width: 12rem"
              ></span>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
    <div class="divider border-top"></div>
    <div class="bundle-total h5 flex space-between gap-10">
      <span class="text">{{ 'sections.cart.total' | t }}:</span>
      <span class="bundle-total-price-{{ section.id }}">
        {%- if settings.currency_code -%}
          {{ 0 | money_with_currency }}
        {%- else -%}
          {{ 0 | money }}
        {%- endif -%}
      </span>
    </div>
    <button-submit-bundle
      tabindex="0"
      class="button-submit-bundle-{{ section.id }} action block btn btn-primary btn-hover w-full text-center no-underline disabled"
      role="button"
      data-minimum="{{ section_st.minimum }}"
      data-maximum="{{ section_st.maximum }}"
      data-section-id="{{ section.id }}"
      aria-label="{{ 'products.product.add_all_to_cart' | t }}"
    >
      <span class="hidden-on-load transition-short">{{ 'products.product.add_all_to_cart' | t }}</span>
      {%- render 'loader' -%}
    </button-submit-bundle>
    <div class="bundle-footer flex column gap-10">
      {% content_for 'blocks' %}
    </div>
  </div>
</div>
{% schema %}
{
  "name": "t:sections.product-bundle.settings.your_bundle.name",
  "class": "w-full col-1025-w-custom bundle-sidebar",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "t:sections.all.content_setting.heading.label",
      "default": "Heading"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "t:sections.all.content_setting.description.label",
      "default": "<p>Description</p>"
    },
    {
      "type": "select",
      "id": "heading_size",
      "options": [
        {
          "value": "small",
          "label": "t:sections.all.content_header.heading_size.options__1.label"
        },
        {
          "value": "medium",
          "label": "t:sections.all.content_header.heading_size.options__2.label"
        },
        {
          "value": "large",
          "label": "t:sections.all.content_header.heading_size.options__3.label"
        }
      ],
      "default": "small",
      "label": "t:sections.all.content_header.heading_size.label"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "options": [
        {
          "value": "start",
          "label": "t:sections.all.text_alignment.options__1.label"
        },
        {
          "value": "center",
          "label": "t:sections.all.text_alignment.options__2.label"
        },
        {
          "value": "end",
          "label": "t:sections.all.text_alignment.options__3.label"
        }
      ],
      "default": "center",
      "label": "t:sections.all.text_alignment.alignment"
    },
    {
      "type": "checkbox",
      "id": "show_progress_bar",
      "default": true,
      "label": "t:sections.product-bundle.settings.your_bundle.settings.show_progress_bar.label"
    },
    {
        "type": "checkbox",
        "id": "enable_quantity",
        "label": "t:sections.product-bundle.settings.discount.edit_quantity",
        "default": true
    }
  ],
  "blocks": [
    {
      "type": "_icon-with-text-bundle"
    }
  ],
  "presets": [
    {
      "name": "t:sections.product-bundle.settings.your_bundle.name"
    }
  ]
}
{% endschema %}
