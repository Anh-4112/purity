<script type="module" src="{{ 'section-offers-popup.js' | asset_url }}" defer="defer"></script>
{% liquid
  assign section_st = section.settings
  assign items_per_row = section_st.items_per_row
  assign show_navigation = section_st.show_navigation
  assign reveal_slide = section_st.reveal_slide

  assign column_gap_slide = 0
  if section_st.column_gap == 'large'
    assign column_gap_slide = 30
  elsif section_st.column_gap == 'medium'
    assign column_gap_slide = 20
  elsif section_st.column_gap == 'small'
    assign column_gap_slide = 10
  endif
%}
{% style %}
  .modal-offer-wrapper .modal__close svg {
    rotate: 180deg;
  }
  .padding-block {
    padding: 1.5rem 3rem;
  }
  .modal-inner-offer .swiper-vertical {
    touch-action: auto !important;
  }
  icon-close-offer {
    top: -1.8rem;
  }
{% endstyle %}
<scroll-offer class="block fixed left-10 left-md-30 z-5" style="opacity: 0;" tabindex="0">
  <div
    class="subheading_weight pointer lh-normal inline-flex align-center {% if section_st.uppercase %} uppercase{% endif %} fs-{{ section_st.highlight_text_size }} text-color bg-custom{% if section_st.background_color != "rgba(0,0,0,0)" and section_st.background_color != "transparent" and section_st.background_color != blank  %} padding-block btn-rounded{% endif %}"
    style="--color-text: {{ section_st.text_color }};--bg-color-custom: {{ section_st.background_color }};"
  >
    {%- if section_st.highlight_text_icon == 'star' -%}
      {%- render 'icon-star' -%}
    {%- elsif section_st.highlight_text_icon == 'dot' -%}
      {%- render 'icon-dot' -%}
    {%- elsif section_st.highlight_text_icon == 'discount' -%}
      {%- render 'icon-discount' -%}
    {%- endif -%}
    {{ section_st.highlight_text | escape }}
  </div>
  <icon-close-offer
    class="absolute pointer shadow border inline-flex mx-auto rounded-50 overflow-hidden content-center heading-color bg-white w-custom h-custom"
    style="--width: 2.6rem; --height: 2.6rem;"
  >
    <svg width="8" height="8" viewBox="0 0 13 14" fill="none">
      <use href="#icon-close" />
    </svg>
  </icon-close-offer>
</scroll-offer>
<offer-popup class="modal-offer-wrapper modal active-modal-js relative">
  <modal-overlay class="modal-overlay invisible transition-drawer pointer"></modal-overlay>
  <div
    class="modal-inner invisible draw-mb drawer-right-mb bg-white transition-drawer drawer drawer-right fixed right-0 z-15 inset-y-0 w-full"
    style="--drawer-width: 42rem;"
    tabindex="-1"
  >
    <div class="drawer__body p-gutter-x p-1025-30">
      <div class="hidden block-md offer-content__desktop">
        <cart-upsell-product
          class="swiper smooth_scroll"
          data-section-id="{{ section.id }}"
          data-autoplay="false"
          data-effect="slide"
          data-loop="false"
          data-speed="500"
          data-spacing="{{ column_gap_slide }}"
          data-mobile="1"
          data-desktop="2"
          data-tablet="2"
          style="max-height: 100vh;"
        >
          <div class="swiper-wrapper">
            {% content_for 'blocks' %}
          </div>
        </cart-upsell-product>
      </div>
      <div class="flex column gap-{{ column_gap_slide }} offer-content__mobile hidden-md"></div>
    </div>
  </div>
</offer-popup>

{% schema %}
{
  "name": "t:sections.offers-popup.name",
  "tag": "section",
  "class": "overlay-section overlay-offers-popup",
  "max_blocks": 10,
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.general"
    },
    {
      "type": "range",
      "id": "items_per_row",
      "label": "t:sections.all.columns_desktop.label",
      "min": 2,
      "max": 4,
      "step": 0.5,
      "default": 3
    },
    {
      "type": "select",
      "id": "column_gap",
      "options": [
        {
          "value": "no_gap",
          "label": "t:sections.all.padding.column_gap.no_gap"
        },
        {
          "value": "small",
          "label": "t:sections.all.padding.column_gap.small"
        },
        {
          "value": "medium",
          "label": "t:sections.all.padding.column_gap.medium"
        },
        {
          "value": "large",
          "label": "t:sections.all.padding.column_gap.large"
        }
      ],
      "default": "medium",
      "label": "t:sections.all.padding.column_gap.label"
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "default": true,
      "label": "t:sections.all.carousel.show_navigation.label"
    },
    {
      "type": "checkbox",
      "id": "reveal_slide",
      "default": false,
      "label": "t:sections.all.carousel.reveal_slide.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.content_setting.label"
    },
    {
      "type": "select",
      "id": "column_gap_block",
      "options": [
        {
          "value": "no_gap",
          "label": "t:sections.all.padding.column_gap.no_gap"
        },
        {
          "value": "small",
          "label": "t:sections.all.padding.column_gap.small"
        },
        {
          "value": "medium",
          "label": "t:sections.all.padding.column_gap.medium"
        },
        {
          "value": "large",
          "label": "t:sections.all.padding.column_gap.large"
        }
      ],
      "default": "medium",
      "label": "t:sections.all.padding.column_gap.label"
    },
    {
      "type": "select",
      "id": "desktop_vertical_alignment",
      "options": [
        {
          "value": "start",
          "label": "t:sections.image-with-text.settings.desktop_vertical_alignment.top"
        },
        {
          "value": "center",
          "label": "t:sections.image-with-text.settings.desktop_vertical_alignment.middle"
        },
        {
          "value": "end",
          "label": "t:sections.image-with-text.settings.desktop_vertical_alignment.bottom"
        }
      ],
      "default": "start",
      "label": "t:sections.image-with-text.settings.desktop_vertical_alignment.label"
    },
    {
      "type": "select",
      "id": "content_alignment",
      "options": [
        {
          "value": "start",
          "label": "t:sections.all.text_alignment.options__1.label"
        },
        {
          "value": "center",
          "label": "t:sections.all.text_alignment.options__2.label"
        },
        {
          "value": "end",
          "label": "t:sections.all.text_alignment.options__3.label"
        }
      ],
      "default": "start",
      "label": "t:sections.all.text_alignment.label"
    },
    {
      "type": "header",
      "content": "t:sections.offers-popup.popup.label"
    },
    {
      "type": "text",
      "id": "highlight_text",
      "default": "Highlight text",
      "label": "t:sections.multi_content.blocks.badge"
    },
    {
      "type": "select",
      "id": "highlight_text_icon",
      "options": [
        {
          "value": "none",
          "label": "t:sections.all.content_setting.highlight_text.settings.icons.options__1.label"
        },
        {
          "value": "star",
          "label": "t:sections.all.content_setting.highlight_text.settings.icons.options__2.label"
        },
        {
          "value": "dot",
          "label": "t:sections.all.content_setting.highlight_text.settings.icons.options__3.label"
        },
        {
          "value": "discount",
          "label": "t:sections.all.content_setting.highlight_text.settings.icons.options__4.label"
        }
      ],
      "default": "discount",
      "label": "t:sections.all.content_setting.highlight_text.settings.icons.label"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "t:sections.image-with-text.settings.background_color",
      "default": "#D0473E"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "t:sections.image-with-text.settings.text_color",
      "default": "#ffffff"
    }
  ],
  "blocks": [
    {
      "type": "group-image-with-text-offer"
    }
  ]
}
{% endschema %}
