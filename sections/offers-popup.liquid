<script type="module" src="{{ 'section-offers-popup.js' | asset_url }}" defer="defer"></script>
{% liquid
  assign section_st = section.settings
  assign items_per_row = section_st.items_per_row
  assign show_navigation = section_st.show_navigation
  assign reveal_slide = section_st.reveal_slide

  assign column_gap_slide = 0
  if section_st.column_gap == 'large'
    assign column_gap_slide = 30
  elsif section_st.column_gap == 'medium'
    assign column_gap_slide = 20
  elsif section_st.column_gap == 'small'
    assign column_gap_slide = 10
  endif
%}
{% style %}
  .modal-offer-wrapper .modal__close svg {
    rotate: 180deg;
  }
  scroll-offer {
    position: fixed;
    bottom: 3rem;
    left: 3rem;
    z-index: 10;
    --btn-radius: 3rem;
  }

  .padding-block {
    padding: 1.5rem 3rem;
  }

  .modal-offer-wrapper .modal__close {
    left: 50%;
    transform: translate(-50%, -25px);
  }
  @media screen and (max-width: 767.98px) {
    .modal-inner-offer .drawer__body {
      height: calc(100vh - 4rem);
      overflow: auto;
    }
  }
  -- > .modal-inner-offer .swiper-vertical {
    touch-action: auto !important;
  }
  icon-close-offer {
    width: 2.6rem;
    height: 2.6rem;
    top: -1.8rem;
  }
{% endstyle %}
<scroll-offer class="block" style="opacity: 0;">
  <div
    class="subheading_weight pointer lh-normal inline-flex align-center {% if section_st.uppercase %} uppercase{% endif %} fs-{{ section_st.highlight_text_size }} text-color bg-custom{% if section_st.background_color != "rgba(0,0,0,0)" and section_st.background_color != "transparent" and section_st.background_color != blank  %} padding-block btn-rounded{% endif %}"
    style="--color-text: {{ section_st.text_color }};--bg-color-custom: {{ section_st.background_color }};"
  >
    {%- if section_st.highlight_text_icon == 'star' -%}
      {%- render 'icon-star' -%}
    {%- elsif section_st.highlight_text_icon == 'dot' -%}
      {%- render 'icon-dot' -%}
    {%- elsif section_st.highlight_text_icon == 'discount' -%}
      {%- render 'icon-discount' -%}
    {%- endif -%}
    {{ section_st.highlight_text | escape }}
  </div>
  <icon-close-offer class="absolute pointer shadow border inline-flex mx-auto rounded-50 overflow-hidden content-center heading-color bg-white">
    <svg width="8" height="8" viewBox="0 0 13 14" fill="none">
      <use href="#icon-close" />
    </svg>
  </icon-close-offer>
</scroll-offer>
<offer-popup class="modal-offer-wrapper modal active-modal-js relative">
  <modal-overlay class="modal-overlay invisible transition-drawer pointer"></modal-overlay>
  <div
    class="modal-inner modal-inner-offer drawer-bottom transition-drawer invisible fixed z-15 bg-white w-full bottom-0 inset-x-0"
    style="--drawer-width:100%;"
  >
    <button
      is="button-close-model"
      class="modal__close pointer btn-reset w-50 h-50 bg-white rounded-50 inline-flex content-center absolute z-3"
      aria-label="Close"
    >
      <svg width="8" height="10" fill="none" class="color-black">
        <path fill="currentColor" d="M7.797 4.203h.016A.636.636 0 0 1 8 4.672a.67.67 0 0 1-.188.469.69.69 0 0 1-.484.187.67.67 0 0 1-.469-.187L4 2.28l-2.86 2.86a.69.69 0 0 1-.484.187.617.617 0 0 1-.453-.187A.644.644 0 0 1 0 4.67c0-.187.068-.343.203-.468L3.531.86A.636.636 0 0 1 4 .672c.188 0 .344.062.469.187l3.328 3.344Zm0 4.656h.016A.69.69 0 0 1 8 9.344a.617.617 0 0 1-.188.453.661.661 0 0 1-.953 0L4 6.937l-2.86 2.86A.661.661 0 0 1 .657 10a.594.594 0 0 1-.453-.203A.594.594 0 0 1 0 9.344c0-.188.068-.35.203-.485l3.328-3.328A.611.611 0 0 1 4 5.328c.188 0 .344.068.469.203L7.797 8.86Z"></path>
      </svg>
    </button>
    <div class="drawer__body p-gutter-x p-1025-30">
      <div class="hidden block-md offer-content__desktop">
        <slide-section
          class="swiper{% if reveal_slide %} reveal_on_scroll{% endif %}"
          data-section-id="{{ section.id }}"
          data-autoplay="false"
          data-effect="slide"
          data-loop="false"
          data-speed="500"
          data-spacing="{{ column_gap_slide }}"
          data-mobile="1"
          data-desktop="{{ items_per_row }}"
          data-tablet="1.5"
          data-free-mode="true"
        >
          {% if show_navigation %}
            {%- render 'swiper-navigation' -%}
          {% endif %}
          <div class="swiper-wrapper">
            {% content_for 'blocks' %}
          </div>
        </slide-section>
      </div>
      <div class="flex column gap-{{ column_gap_slide }} offer-content__mobile hidden-md"></div>
    </div>
  </div>
</offer-popup>

{% schema %}
{
  "name": "t:sections.offers-popup.name",
  "tag": "section",
  "class": "overlay-section overlay-offers-popup",
  "max_blocks": 10,
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.general"
    },
    {
      "type": "range",
      "id": "items_per_row",
      "label": "t:sections.all.columns_desktop.label",
      "min": 2,
      "max": 4,
      "step": 0.5,
      "default": 3
    },
    {
      "type": "select",
      "id": "column_gap",
      "options": [
        {
          "value": "no_gap",
          "label": "t:sections.all.padding.column_gap.no_gap"
        },
        {
          "value": "small",
          "label": "t:sections.all.padding.column_gap.small"
        },
        {
          "value": "medium",
          "label": "t:sections.all.padding.column_gap.medium"
        },
        {
          "value": "large",
          "label": "t:sections.all.padding.column_gap.large"
        }
      ],
      "default": "medium",
      "label": "t:sections.all.padding.column_gap.label"
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "default": true,
      "label": "t:sections.all.carousel.show_navigation.label"
    },
    {
      "type": "checkbox",
      "id": "reveal_slide",
      "default": false,
      "label": "t:sections.all.carousel.reveal_slide.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.content_setting.label"
    },
    {
      "type": "select",
      "id": "column_gap_block",
      "options": [
        {
          "value": "no_gap",
          "label": "t:sections.all.padding.column_gap.no_gap"
        },
        {
          "value": "small",
          "label": "t:sections.all.padding.column_gap.small"
        },
        {
          "value": "medium",
          "label": "t:sections.all.padding.column_gap.medium"
        },
        {
          "value": "large",
          "label": "t:sections.all.padding.column_gap.large"
        }
      ],
      "default": "medium",
      "label": "t:sections.all.padding.column_gap.label"
    },
    {
      "type": "select",
      "id": "desktop_vertical_alignment",
      "options": [
        {
          "value": "start",
          "label": "t:sections.image-with-text.settings.desktop_vertical_alignment.top"
        },
        {
          "value": "center",
          "label": "t:sections.image-with-text.settings.desktop_vertical_alignment.middle"
        },
        {
          "value": "end",
          "label": "t:sections.image-with-text.settings.desktop_vertical_alignment.bottom"
        }
      ],
      "default": "start",
      "label": "t:sections.image-with-text.settings.desktop_vertical_alignment.label"
    },
    {
      "type": "select",
      "id": "content_alignment",
      "options": [
        {
          "value": "start",
          "label": "t:sections.all.text_alignment.options__1.label"
        },
        {
          "value": "center",
          "label": "t:sections.all.text_alignment.options__2.label"
        },
        {
          "value": "end",
          "label": "t:sections.all.text_alignment.options__3.label"
        }
      ],
      "default": "start",
      "label": "t:sections.all.text_alignment.label"
    },
    {
      "type": "header",
      "content": "t:sections.offers-popup.popup.label"
    },
    {
      "type": "text",
      "id": "highlight_text",
      "default": "Highlight text",
      "label": "t:sections.multi_content.blocks.badge"
    },
    {
      "type": "select",
      "id": "highlight_text_icon",
      "options": [
        {
          "value": "none",
          "label": "t:sections.all.content_setting.highlight_text.settings.icons.options__1.label"
        },
        {
          "value": "star",
          "label": "t:sections.all.content_setting.highlight_text.settings.icons.options__2.label"
        },
        {
          "value": "dot",
          "label": "t:sections.all.content_setting.highlight_text.settings.icons.options__3.label"
        },
        {
          "value": "discount",
          "label": "t:sections.all.content_setting.highlight_text.settings.icons.options__4.label"
        }
      ],
      "default": "discount",
      "label": "t:sections.all.content_setting.highlight_text.settings.icons.label"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "t:sections.image-with-text.settings.background_color",
      "default": "#D0473E"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "t:sections.image-with-text.settings.text_color",
      "default": "#ffffff"
    }
  ],
  "blocks": [
    {
      "type": "group-image-with-text-offer"
    }
  ]
}
{% endschema %}
