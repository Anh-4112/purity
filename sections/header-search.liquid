{% liquid
  assign the_settings = settings
  assign search_type = the_settings.search_type
  assign search_popular_keywords = the_settings.search_popular_keywords
  assign predictive_search_enabled = the_settings.predictive_search_enabled
  assign search_product_recommended = the_settings.search_product_recommended
  assign show_search_vendor = the_settings.show_search_vendor
  if show_search_vendor
    assign show_search_vendor = false
  endif
  assign show_search_price = the_settings.show_search_price
  if show_search_price
    assign show_search_price = false
  endif
%}
<script type="module" src="{{ 'search.js' | asset_url }}"></script>
<action-search
  id="{{ section.id }}"
  class="modal pointer-none active-modal-js {% if search_type == 'drawer' %}search-type-drawer{% else %}search-type-popup{% endif %}"
  data-section-id="{{ section.id }}"
  data-type="{{ search_type }}"
  tabindex="0"
  role="dialog"
>
  <modal-overlay class="modal-overlay pointer invisible transition"></modal-overlay>
  <div class="modal-inner invisible drawer drawer-right fixed right-0 z-15 inset-y-0 bg-white w-full">
    <button
      is="button-close-model"
      class="modal__close pointer btn-reset wh-40 inline-flex content-center absolute z-3 top-0 right-0"
      aria-label="Close"
    >
      <svg width="13" height="14" viewBox="0 0 13 14" fill="none">
        <path d="M0.282609 2.06784C0.0942029 1.89363 0 1.68314 0 1.43635C0 1.17504 0.0942029 0.950028 0.282609 0.761307C0.456522 0.587102 0.673913 0.5 0.934783 0.5C1.19565 0.5 1.41304 0.587102 1.58696 0.761307L6.5 5.68258L11.413 0.761307C11.587 0.587102 11.8043 0.5 12.0652 0.5C12.3261 0.5 12.5435 0.587102 12.7174 0.761307C12.9058 0.950028 13 1.17504 13 1.43635C13 1.68314 12.9058 1.89363 12.7174 2.06784L7.80435 6.98911L12.7174 11.9104C12.9058 12.0991 13 12.3241 13 12.5854C13 12.8322 12.9058 13.0427 12.7174 13.2169C12.5435 13.4056 12.3261 13.5 12.0652 13.5C11.8043 13.5 11.587 13.4056 11.413 13.2169L6.5 8.31742L1.58696 13.2169C1.41304 13.4056 1.19565 13.5 0.934783 13.5C0.673913 13.5 0.456522 13.4056 0.282609 13.2169C0.0942029 13.0427 0 12.8322 0 12.5854C0 12.3241 0.0942029 12.0991 0.282609 11.9104L5.19565 6.98911L0.282609 2.06784Z" fill="currentColor"></path>
      </svg>
    </button>
    <div class="drawer__body h-full overflow-y-auto custom-scrollbar">
      <div
        id="search-form"
        class="search-form"
      >
        <form
          action="{{ routes.search_url }}"
          id="search_mini_form"
          method="get"
          role="search"
          class="search search-modal__form"
        >
          <input type="hidden" name="options[prefix]" value="last">
          <div class="field">
            <button
              type="submit"
              class="button btn-reset search__button"
              tabindex="0"
              aria-label="{{ 'general.search.search' | t }}"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="22px">
                <path d="M 19 3 C 13.488281 3 9 7.488281 9 13 C 9 15.394531 9.839844 17.589844 11.25 19.3125 L 3.28125 27.28125 L 4.71875 28.71875 L 12.6875 20.75 C 14.410156 22.160156 16.605469 23 19 23 C 24.511719 23 29 18.511719 29 13 C 29 7.488281 24.511719 3 19 3 Z M 19 5 C 23.429688 5 27 8.570313 27 13 C 27 17.429688 23.429688 21 19 21 C 14.570313 21 11 17.429688 11 13 C 11 8.570313 14.570313 5 19 5 Z"></path>
              </svg>
            </button>
            <input
              class="search__input field__input"
              type="search"
              name="q"
              placeholder="{{ 'general.search.search' | t }}"
              maxlength="128"
              id="Search-In-Modal"
              {% if predictive_search_enabled %}
                autocomplete="off"
                autocorrect="off"
                autocapitalize="off"
                spellcheck="off"
              {% endif %}
            >
            <label class="visually-hidden" for="Search-In-Modal"> {{ 'general.search.search' | t }}</label>
            <div class="search__action-right">
              <button type="reset" class="search__reset" aria-label="{{ 'general.search.clear' | t }}">
                <svg width="13" height="14" viewBox="0 0 13 14" fill="none">
                  <path d="M0.282609 2.06784C0.0942029 1.89363 0 1.68314 0 1.43635C0 1.17504 0.0942029 0.950028 0.282609 0.761307C0.456522 0.587102 0.673913 0.5 0.934783 0.5C1.19565 0.5 1.41304 0.587102 1.58696 0.761307L6.5 5.68258L11.413 0.761307C11.587 0.587102 11.8043 0.5 12.0652 0.5C12.3261 0.5 12.5435 0.587102 12.7174 0.761307C12.9058 0.950028 13 1.17504 13 1.43635C13 1.68314 12.9058 1.89363 12.7174 2.06784L7.80435 6.98911L12.7174 11.9104C12.9058 12.0991 13 12.3241 13 12.5854C13 12.8322 12.9058 13.0427 12.7174 13.2169C12.5435 13.4056 12.3261 13.5 12.0652 13.5C11.8043 13.5 11.587 13.4056 11.413 13.2169L6.5 8.31742L1.58696 13.2169C1.41304 13.4056 1.19565 13.5 0.934783 13.5C0.673913 13.5 0.456522 13.4056 0.282609 13.2169C0.0942029 13.0427 0 12.8322 0 12.5854C0 12.3241 0.0942029 12.0991 0.282609 11.9104L5.19565 6.98911L0.282609 2.06784Z" fill="currentColor"></path>
                </svg>
                <div class="loading__search"></div>
              </button>
            </div>
          </div>
          {%- if search_popular_keywords != blank -%}
            {%- capture link_search_keyword -%}
              {{ routes.search_url }}?type=product&options%5Bprefix%5D=last&q=
            {%- endcapture -%}
            <div id="search-keyword" class="search-keyword">
              <ul class="search-keyword-list">
                {%- assign search_popular_keywords = search_popular_keywords
                  | replace: ' ,', ','
                  | replace: ', ', ','
                  | split: ','
                -%}
                {%- for qr in search_popular_keywords -%}
                  {%- assign search_keywords = qr | strip -%}
                  {%- if search_keywords -%}
                    <li>
                      <a
                        class="recommend-search__item"
                        href="{{ link_search_keyword }}{{ search_keywords }}"
                        aria-label="{{ search_keywords }}"
                        role="option"
                        aria-selected="false"
                      >
                        {{ search_keywords }}
                      </a>
                    </li>
                  {%- endif -%}
                {%- endfor -%}
              </ul>
            </div>
          {%- endif -%}
          {%- if search_product_recommended != blank or predictive_search_enabled != false -%}
            <div
              class="search-content"
              role="listbox"
            >
              {%- if predictive_search_enabled != false -%}
                <div class="predictive-search"></div>
              {%- endif -%}
              {%- if search_product_recommended != blank -%}
                <div class="recommend-search" data-predictive-search>
                  {%- if search_product_recommended -%}
                    {%- assign sizes = '(min-width: 1200px) calc((1200px -  30px * 3) * 0.2), (min-width: 768px) calc( (100vw - 30px - 30px * 2 ) * 0.33), 80px' -%}
                    <template class="template-recommended-default">
                      <div class="search-product">
                        <h3 class="heading-color">
                          {{ 'general.search.popular_products' | t }}
                        </h3>
                        <div class="grid-cols">
                          {%- for product in search_product_recommended -%}
                            {% render 'card-product',
                              card_product: product,
                              disable_hover_image: true,
                              disable_badge: true,
                              disable_rate: true,
                              disable_price: show_search_price,
                              disable_vendor: show_search_vendor,
                              disable_color_swatches: true,
                              disable_quickview: true,
                              disable_show_video: true,
                              sizes: sizes
                            %}
                          {%- endfor -%}
                        </div>
                      </div>
                    </template>
                    {% if search_type == 'popup' %}
                      <template class="template-recommended-popup">
                        <div class="search-product">
                          <h3 class="heading-color">
                            {{ 'general.search.popular_products' | t }}
                          </h3>
                          <slide-section
                            class="swiper hover-action"
                            data-section-id="{{ section.id }}"
                            data-autoplay="false"
                            data-effect="slide"
                            data-loop="false"
                            data-speed="500"
                            data-spacing="15"
                            data-mobile="5"
                            data-desktop="5"
                            data-tablet="5"
                          >
                            {%- render 'swiper-navigation', show_on_hover: true -%}
                            <div class="swiper-wrapper">
                              {%- for product in search_product_recommended -%}
                                {% render 'card-product',
                                  card_product: product,
                                  disable_hover_image: true,
                                  disable_badge: true,
                                  disable_rate: true,
                                  disable_price: show_search_price,
                                  disable_vendor: show_search_vendor,
                                  disable_color_swatches: true,
                                  disable_quickview: true,
                                  disable_show_video: true,
                                  class: ' swiper-slide',
                                  sizes: sizes
                                %}
                              {%- endfor -%}
                            </div>
                          </slide-section>
                        </div>
                      </template>
                    {%- endif -%}
                  {%- endif -%}
                </div>
              {%- endif -%}
            </div>
          {%- endif -%}
        </form>
      </div>
    </div>
  </div>
</action-search>
{% schema %}
{
  "name": "t:sections.search.name",
  "tag": "section",
  "class": "overlay-section overlay-search"
}
{% endschema %}
