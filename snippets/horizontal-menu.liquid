{% if link.links.size > 0 %}
  {%- if type == 'classic' -%}
    <div
      class="submenu classic transition invisible bg-white z-1{% if menu_mobile == blank %} py-30 absolute submenu-desktop {{ section_st.dropdowns_animation }} shadow{% else %} sub-mb absolute inset-0 drawer drawer-right{% endif %}"
    >
      {%- if menu_mobile != blank -%}
        <div class="submenu-header flex align-center justify-between p-24 border-bottom sticky top-0 bg-white z-3">
          <div class="back-menu flex align-center gap-custom pointer" style="--gap: 24">
            <svg class="icon-back min-w-custom" width="8" height="14" viewBox="0 0 8 14" fill="none">
              <use href="#icon-back" />
            </svg>
            <span class="fs-18 menu_weight">{{- link.title -}}</span>
          </div>
          <button
            class="modal__close btn-close-menu top-10 right-10 btn-reset rounded-50 inline-flex content-center pointer"
            style="--custom-width: 2.4rem;"
            aria-label="{{ 'accessibility.button.close' | t }}"
            is="button-close-model"
          >
            <svg width="15" height="15" viewBox="0 0 15 15" fill="none">
              <use href="#icon-close" />
            </svg>
          </button>
        </div>
      {%- endif -%}
  {%- else -%}
    {%- if menu_mobile != blank -%}
      <div class="submenu-header flex align-center justify-between p-24 border-bottom sticky top-0 bg-white z-3">
        <div class="back-menu flex align-center gap-custom pointer" style="--gap: 24">
          <svg class="icon-back min-w-custom" width="8" height="14" viewBox="0 0 8 14" fill="none">
            <use href="#icon-back" />
          </svg>
          <span class="fs-18 menu_weight">{{- link.title -}}</span>
        </div>
        <button
          class="modal__close btn-close-menu top-10 right-10 btn-reset rounded-50 inline-flex content-center pointer"
          style="--custom-width: 2.4rem;"
          aria-label="{{ 'accessibility.button.close' | t }}"
          is="button-close-model"
        >
          <svg width="15" height="15" viewBox="0 0 15 15" fill="none">
            <use href="#icon-close" />
          </svg>
        </button>
      </div>
    {%- endif -%}
  {%- endif -%}
  <ul
    class="menu list-unstyled{% if type != 'classic' and menu_mobile == blank %} sub-menu-mega flex wrap flex-cols gap row-gap-30{% elsif menu_mobile != blank%} px-24 pt-12{% endif %}"
  >
    {% for child_link in link.links %}
      <li class="menu-link{% if child_link.links.size > 0 %} have-child{% if menu_mega == blank %} relative{% endif %}{% endif %}{% if menu_mega == blank and menu_mobile == blank %} px-20{% endif %}">
        {%- if child_link.links.size > 0 -%}
          {% if menu_mega != blank %}
            <a
              class="menu__item level-2 py-6 heading-style inline-block h6 mb-13 inside-out-effect relative"
              href="{{ link.url }}"
              aria-label="{{ grandchild_link.title }}"
            >
              {{- child_link.title -}}
            </a>
          {%- else -%}
            <details class="details-normal" is="submenu-details" open>
              <summary
                class="menu__item level-2 py-6 fs-18 heading-style flex align-center gap-5 justify-between inside-out-hover"
                data-href="{{ link.url }}"
                aria-label="{{ child_link.title }}"
              >
                <span class="menu__title inside-out-effect relative">
                  {{- child_link.title -}}
                </span>
                {% if menu_mobile == blank %}
                  {% if settings.rtl %}
                    <svg class="icon-down block" width="6" height="11">
                      <use href="#icon-back" />
                    </svg>
                  {% else %}
                    <svg class="icon-down block" width="6" height="11">
                      <use href="#icon-next" />
                    </svg>
                  {% endif %}
                {% else %}
                  <span class="toggle-menu">
                    <svg class="icon icon-down transition-short" width="9" height="6" viewBox="0 0 9 6">
                      <use href="#icon-arrow-down" />
                    </svg>
                  </span>
                {% endif %}
              </summary>
            </details>
          {% endif %}
          <ul class="sub-children-menu list-unstyled overflow-hidden-mb{% if menu_mega == blank and menu_mobile == blank %} classic transition invisible py-20 absolute z-1 top-0 left-100 bg-white shadow{% endif %}">
            {% for grandchild_link in child_link.links %}
              <li class="menu-link{% if menu_mega == blank and menu_mobile == blank %} px-20{% endif %}">
                <a
                  class="menu__item level-3 inline-block py-6 inside-out-effect relative"
                  href="{{ grandchild_link.url }}"
                  aria-label="{{ grandchild_link.title }}"
                >
                  {{- grandchild_link.title -}}
                </a>
              </li>
            {% endfor %}
          </ul>
        {%- else -%}
          <a
            class="menu__item level-2 py-6 inside-out-effect relative{% if menu_mega != blank %} heading-style inline-block h6 mb-13{% endif %}"
            aria-label="{{ child_link.title }}"
            href="{{ child_link.url }}"
          >
            {{- child_link.title -}}
          </a>
        {%- endif -%}
      </li>
    {% endfor %}
  </ul>
  {%- if type == 'classic' -%}
    </div>
  {%- endif -%}
{%- else -%}
  {%- if menu_mobile != blank -%}
    <div class="submenu-header flex align-center justify-between p-24 border-bottom sticky top-0 bg-white z-3">
      <div class="back-menu flex align-center gap-custom pointer" style="--gap: 24">
        <svg class="icon-back min-w-custom" width="8" height="14" viewBox="0 0 8 14" fill="none">
          <use href="#icon-back" />
        </svg>
        <span class="fs-18 menu_weight">{{- link.title -}}</span>
      </div>
      <button
        class="modal__close btn-close-menu top-10 right-10 btn-reset rounded-50 inline-flex content-center pointer"
        style="--custom-width: 2.4rem;"
        aria-label="{{ 'accessibility.button.close' | t }}"
        is="button-close-model"
      >
        <svg width="15" height="15" viewBox="0 0 15 15" fill="none">
          <use href="#icon-close" />
        </svg>
      </button>
    </div>
  {%- endif -%}
{% endif %}
