{% liquid
  assign mobile_thumbnails = section_st.mobile_thumbnails
  assign enable_video_autoplay = section_st.enable_video_autoplay
  assign media_position = section_st.media_position
  assign layout = 'grid'
  if desktop_layout == 'thumbnail_left' or desktop_layout == 'thumbnail_bottom'
    assign layout = 'thumbnail'
  elsif desktop_layout == 'stack'
    assign layout = 'stack'
  endif

  if type_section == 'featured'
    assign layout = 'thumbnail'
    assign desktop_layout = 'thumbnail_left'
  endif
  if type_section == 'quickview'
    assign layout = 'grid'
    assign desktop_layout = 'two_columns'
  endif
%}
{%- capture col -%}
  {% if desktop_layout == 'two_columns' and type_section != 'quickview' %} --col-number: 2;{% else %}--col-number: 1;{% endif %}
{%- endcapture -%}
<script type="module" src="{{ 'media-gallery.js' | asset_url }}"></script>
<div class="block__media-gallery sticky top-20">
  <media-gallery
    class="media-gallery block"
    data-section-id="{{ section.id }}"
    data-thumb-direction="{% if desktop_layout == 'thumbnail_left' %}vertical{% else %}horizontal{% endif %}"
    data-auto-play-video="{% if enable_video_autoplay %}true{% else %}false{% endif %}"
  >
    <div class="product__media-gallery product-{{ layout }} {{ desktop_layout }}{% if desktop_layout == 'thumbnail_left' %} flex-md{% if media_position == 'right' %} flex-start{% else %} flex-end{% endif %} relative overflow-hidden{% endif %}">
      {% case layout %}
        {% when 'thumbnail' %}
          <div id="GalleryMainViewer-{{ section.id }}" class="media-main-swiper">
            <div class="swiper-wrapper-main swiper hover-action">
              {%- render 'swiper-navigation', show_on_hover: true -%}
              <div class="swiper-wrapper">
                {% render 'product-media',
                  images: images,
                  product: product,
                  section_st: section_st,
                  type_section: type_section,
                  motion: true,
                  class: ' swiper-slide'
                %}
              </div>
              <div
                class="swiper-pagination absolute fs-small lh-normal"
              ></div>
            </div>
          </div>
          <div
            id="GalleryThumbnailViewer-{{ section.id }}"
            class="media-thumb-swiper{% if layout == 'thumbnail' %} mt-10{% endif %}{% if desktop_layout == 'thumbnail_left' %} mt-md-0{% endif %}{% if mobile_thumbnails == 'hidden_thumbnail' %} hidden block-md{% endif %}{% if desktop_layout == 'thumbnail_left' %}{% if media_position == 'right' %} right-0{% else %} left-0{% endif %}{% endif %}"
          >
            <div
              class="swiper-wrapper-thumbnail swiper"
              data-mobile="5"
              data-desktop="5"
              data-tablet="5"
            >
              <div class="swiper-wrapper">
                {% render 'product-media',
                  images: images,
                  product: product,
                  section_st: section_st,
                  thumbnail: true,
                  type_section: type_section,
                  class: ' swiper-slide pointer'
                %}
              </div>
            </div>
          </div>
        {% when 'stack' %}
          <grid-gallery id="GalleryViewer-{{ section.id }}" class="grid gap-10 stacked stacked-swiper-mobile">
            {% render 'product-media',
              images: images,
              product: product,
              section_st: section_st,
              type_section: type_section,
              motion: true,
              class: ' grid-item'
            %}
          </grid-gallery>
        {% else %}
          <grid-gallery
            id="GalleryViewer-{{ section.id }}"
            class="grid grid-cols gap-10 grid-swiper-mobile"
            style="{{ col | strip | strip_newlines }}"
          >
            {% render 'product-media',
              images: images,
              product: product,
              section_st: section_st,
              type_section: type_section,
              motion: true,
              class: ' grid-item'
            %}
          </grid-gallery>
      {% endcase %}
    </div>
  </media-gallery>
</div>
